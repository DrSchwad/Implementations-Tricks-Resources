{"title":"E. Rescue Niwen!","contestId":"1562","problemIndex":"E","timeLimit":"2 seconds","memLimit":"512 megabytes","inputFormat":"standard input","outputFormat":"standard output","problemHtml":"<div class=\"epigraph\"><div class=\"epigraph-text\"><span class=\"tex-font-size-small\"> Morning desert sun horizon<p>Rise above the sands of time...</p></span></div><div class=\"epigraph-source\"><span class=\"tex-font-size-small\">Fates Warning, &quot;Exodus&quot;</span></div></div><p>After crossing the Windswept Wastes, Ori has finally reached the Windtorn Ruins to find the Heart of the Forest! However, the ancient repository containing this priceless Willow light did not want to open!</p><p>Ori was taken aback, but the Voice of the Forest explained to him that the cunning Gorleks had decided to add protection to the repository.</p><p>The Gorleks were very fond of the &quot;string expansion&quot; operation. They were also very fond of increasing subsequences.</p><p>Suppose a string $$$s_1s_2s_3 \\ldots s_n$$$ is given. Then its &quot;expansion&quot; is defined as the sequence of strings $$$s_1$$$, $$$s_1 s_2$$$, ..., $$$s_1 s_2 \\ldots s_n$$$, $$$s_2$$$, $$$s_2 s_3$$$, ..., $$$s_2 s_3 \\ldots s_n$$$, $$$s_3$$$, $$$s_3 s_4$$$, ..., $$$s_{n-1} s_n$$$, $$$s_n$$$. For example, the &quot;expansion&quot; the string &apos;<span class=\"tex-font-style-tt\">abcd</span>&apos; will be the following sequence of strings: &apos;<span class=\"tex-font-style-tt\">a</span>&apos;, &apos;<span class=\"tex-font-style-tt\">ab</span>&apos;, &apos;<span class=\"tex-font-style-tt\">abc</span>&apos;, &apos;<span class=\"tex-font-style-tt\">abcd</span>&apos;, &apos;<span class=\"tex-font-style-tt\">b</span>&apos;, &apos;<span class=\"tex-font-style-tt\">bc</span>&apos;, &apos;<span class=\"tex-font-style-tt\">bcd</span>&apos;, &apos;<span class=\"tex-font-style-tt\">c</span>&apos;, &apos;<span class=\"tex-font-style-tt\">cd</span>&apos;, &apos;<span class=\"tex-font-style-tt\">d</span>&apos;. </p><p>To open the ancient repository, Ori must find the size of the largest increasing subsequence of the &quot;expansion&quot; of the string $$$s$$$. Here, strings are compared lexicographically.</p><p>Help Ori with this task!</p><p>A string $$$a$$$ is lexicographically smaller than a string $$$b$$$ if and only if one of the following holds:</p><ul><li> $$$a$$$ is a prefix of $$$b$$$, but $$$a \\ne b$$$;</li><li> in the first position where $$$a$$$ and $$$b$$$ differ, the string $$$a$$$ has a letter that appears earlier in the alphabet than the corresponding letter in $$$b$$$.</li></ul>","inSpecsHtml":"<div class=\"section-title\">Input</div><p>Each test contains multiple test cases.</p><p>The first line contains one positive integer $$$t$$$ ($$$1 \\le t \\le 10^3$$$), denoting the number of test cases. Description of the test cases follows.</p><p>The first line of each test case contains one positive integer $$$n$$$ ($$$1 \\le n \\le 5000$$$)&#xA0;&#x2014; length of the string.</p><p>The second line of each test case contains a non-empty string of length $$$n$$$, which consists of lowercase latin letters.</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^4$$$.</p>","outSpecsHtml":"<div class=\"section-title\">Output</div><p>For every test case print one non-negative integer&#xA0;&#x2014; the answer to the problem.</p>","noteHtml":"<div class=\"section-title\">Note</div><p>In first test case the &quot;expansion&quot; of the string is: &apos;<span class=\"tex-font-style-tt\">a</span>&apos;, &apos;<span class=\"tex-font-style-tt\">ac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">acb</span>&apos;, &apos;<span class=\"tex-font-style-tt\">acba</span>&apos;, &apos;<span class=\"tex-font-style-tt\">acbac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">c</span>&apos;, &apos;<span class=\"tex-font-style-tt\">cb</span>&apos;, &apos;<span class=\"tex-font-style-tt\">cba</span>&apos;, &apos;<span class=\"tex-font-style-tt\">cbac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">b</span>&apos;, &apos;<span class=\"tex-font-style-tt\">ba</span>&apos;, &apos;<span class=\"tex-font-style-tt\">bac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">a</span>&apos;, &apos;<span class=\"tex-font-style-tt\">ac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">c</span>&apos;. The answer can be, for example, &apos;<span class=\"tex-font-style-tt\">a</span>&apos;, &apos;<span class=\"tex-font-style-tt\">ac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">acb</span>&apos;, &apos;<span class=\"tex-font-style-tt\">acba</span>&apos;, &apos;<span class=\"tex-font-style-tt\">acbac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">b</span>&apos;, &apos;<span class=\"tex-font-style-tt\">ba</span>&apos;, &apos;<span class=\"tex-font-style-tt\">bac</span>&apos;, &apos;<span class=\"tex-font-style-tt\">c</span>&apos;.</p>","sampleTestcases":[{"id":1631008566074,"input":"7\n5\nacbac\n8\nacabacba\n12\naaaaaaaaaaaa\n10\nabacabadac\n8\ndcbaabcd\n3\ncba\n6\nsparky\n","output":"9\n17\n12\n29\n14\n3\n9\n"}],"submitUrl":"https://codeforces.com/contest/1562/submit","language":"c++","isPartOfContest":true}