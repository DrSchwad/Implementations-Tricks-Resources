{"title":"J. Japanese Game","contestId":"1510","contestName":"2020-2021 ICPC, NERC, Northern Eurasia Onsite (Unrated, Online Mirror, ICPC Rules, Teams Preferred)","problemIndex":"J","timeLimit":"3 seconds","memLimit":"512 megabytes","inputFormat":"standard input","outputFormat":"standard output","problemHtml":"<p>Joseph really likes the culture of Japan. Last year he learned Japanese traditional clothes and visual arts and now he is trying to find out the secret of the Japanese game called Nonogram.</p><p>In the one-dimensional version of the game, there is a row of $$$n$$$ empty cells, some of which are to be filled with a pen. There is a description of a solution called a <span class=\"tex-font-style-underline\">profile</span>&nbsp;— a sequence of positive integers denoting the lengths of consecutive sets of filled cells. For example, the profile of $$$[4, 3, 1]$$$ means that there are sets of four, three, and one filled cell, in that order, with at least one empty cell between successive sets.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/7a2ec6eef2a8990ca87369275e00ff3d727142b6.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"><p>A suitable solution for $$$n = 12$$$ and $$$p = [4, 3, 1]$$$. </p></center><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/576966c8c448e6c57711c7c8c48b57ee891143df.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"><p>A wrong solution: the first four filled cells should be consecutive. </p></center><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/fcabfef8f4c2e5ea68b94a6ec84ba5d3930b38f0.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"><p>A wrong solution: there should be at least one empty cell before the last filled cell. </p></center><p>Joseph found out that for some numbers $$$n$$$ and profiles $$$p$$$ there are lots of ways to fill the cells to satisfy the profile. Now he is in the process of solving a nonogram consisting of $$$n$$$ cells and a profile $$$p$$$. He has already created a <span class=\"tex-font-style-underline\">mask</span> of $$$p$$$&nbsp;— he has filled all the cells that must be filled in every solution of the nonogram.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/e9defc82c67384b93c6d14f4cc99554ea8f3adf6.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"><p>The mask for $$$n = 12$$$ and $$$p = [4, 3, 1]$$$: all the filled cells above are filled in every solution. </p></center><p>After a break, he lost the source profile $$$p$$$. He only has $$$n$$$ and the mask $$$m$$$. Help Joseph find any profile $$$p'$$$ with the mask $$$m$$$ or say that there is no such profile and Joseph has made a mistake.</p>","inSpecsHtml":"<div class=\"section-title\">Input</div><p>The only line contains a string $$$m$$$&nbsp;— the mask of the source profile $$$p$$$. The length of $$$m$$$ is $$$n$$$ ($$$1 \\le n \\le 100\\,000$$$). The string $$$m$$$ consists of symbols <span class=\"tex-font-style-tt\">#</span> and <span class=\"tex-font-style-tt\">_</span>&nbsp;— denoting filled and empty cells respectively.</p>","outSpecsHtml":"<div class=\"section-title\">Output</div><p>If there is no profile with the mask $$$m$$$, output the number $$$-1$$$. Otherwise, on the first line, output an integer $$$k$$$&nbsp;— the number of integers in the profile $$$p'$$$. On the second line, output $$$k$$$ integers of the profile $$$p'$$$.</p>","noteHtml":null,"sampleTestcases":[{"id":1618840461247,"input":"__#_____","output":"2\n3 2 \n","result":{"id":1618840461247,"stdout":"2\n3 2\n","stderr":"","exitcode":0,"signal":null,"time":102,"timeout":false}},{"id":1618840461248,"input":"_#\n","output":"-1\n","result":{"id":1618840461248,"stdout":"-1\n","stderr":"","exitcode":0,"signal":null,"time":90,"timeout":false}},{"id":1618840461249,"input":"___\n","output":"0\n\n","result":{"id":1618840461249,"stdout":"0\n\n","stderr":"","exitcode":0,"signal":null,"time":83,"timeout":false}},{"id":1619034300083,"input":"__##________###__","output":"4\r\n4 1 2 5","result":{"id":1619034300083,"stdout":"4\n4 1 2 5\n","stderr":"","exitcode":0,"signal":null,"time":79,"timeout":false}},{"id":1619043626112,"input":"___##_________#_______","output":"6\r\n5 1 2 4 1 1","result":{"id":1619043626112,"stdout":"6\n5 1 2 4 1 1\n","stderr":"","exitcode":0,"signal":null,"time":82,"timeout":false}},{"id":1619043785575,"input":"__#__","output":"1\r\n3","result":{"id":1619043785575,"stdout":"1\n3\n","stderr":"","exitcode":0,"signal":null,"time":83,"timeout":false}}],"submitUrl":"https://codeforces.com/contest/1510/submit","language":"c++","langId":"54","editorial":"<div><p>One can calculate mask $$$m$$$ of profile $$$p$$$ with the following algorithm. Let's place sets of consecutive blocks in $$$p$$$ as left as possible. Let $$$k$$$ be the number of empty cells at the end of the row of $$$n$$$ cells after the placement (maybe $$$0$$$). Then we should erase $$$k$$$ first filled cells in every set of $$$p$$$. If some set consists of less than $$$k$$$ cells then erase all the cells in the set.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/e9defc82c67384b93c6d14f4cc99554ea8f3adf6.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"><p>Example with $$$n = 10$$$. Black cells represent mask $$$m$$$. Grey cells represent the cells we've erased while calculating $$$m$$$. $$$k = 2$$$ in this case. </p></center><p>We are given mask $$$m$$$. If we know the exact profile $$$p$$$ then $$$m$$$ can be found by the algorithm above. Let's iterate over values of $$$k$$$ in this algorithm. It is bounded by the following numbers:</p><ul> <li> Number of empty cells at the beginning of $$$m$$$; </li><li> Number of empty cells at the end of $$$m$$$; </li><li> $$$a_i - 1$$$ where $$$a_i$$$ is the number of empty cells between $$$i$$$-th and $$$i + 1$$$-th sets of consecutive filled cells in mask $$$m$$$. </li></ul><p>Let's try to create a profile $$$p$$$ with mask $$$m$$$ with the specified value of $$$k$$$.</p><p>Every set of consecutive filled cells in $$$m$$$ should be extended to the left with $$$k$$$ filled cells. $$$k$$$ last cells of the row of $$$n$$$ cells should be empty. Let's cut them out. Now we have some sets of consecutive empty cells at the beginning, at the end, and between sets of filled cells.</p><p>If there is exactly one empty cell at the beginning of the row, then such a value of $$$k$$$ is not suitable. Otherwise, let's try to fill some of these cells with sets of $$$1$$$ and $$$2$$$ consecutive cells. Note that we can use sets of $$$2$$$ cells only if $$$k \\ge 2$$$.</p><p>The same algorithm can be used at the end of the row. Also, it can be used between sets of consecutive filled cells: if there is exactly one empty cell between sets, then it is already filled, and if there are exactly two empty cells, then it is impossible.</p><p>It gives us a solution with $$$O(n^2)$$$ time complexity. In the solution above, we haven't used more than $$$2$$$ consecutive cells, so it can be improved as follows. If $$$k \\ge 4$$$ and we have found the exact profile $$$p$$$ then there exists a profile $$$p'$$$ with $$$k' = k - 2$$$. All we need is to add a set of single-filled cells between every pair of adjacent sets of $$$m$$$ and at the end of the row. It means there is no need to check values of $$$k \\ge 4$$$, so the resulting complexity is $$$O(n)$$$.</p></div>"}